<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Data Science Dashboard - AI Anketa</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid #667eea;
        }
        .header h1 {
            color: #333;
            margin: 0;
            font-size: 2.5em;
        }
        .header p {
            color: #666;
            margin: 10px 0 0 0;
            font-size: 1.1em;
        }
        
        .navigation {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 10px;
        }
        
        .nav-link {
            padding: 12px 20px;
            background: white;
            color: #333;
            text-decoration: none;
            border-radius: 8px;
            border: 2px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .nav-link:hover, .nav-link.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
            transform: translateY(-2px);
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .stat-label {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .section {
            margin-bottom: 40px;
            padding: 25px;
            background: #f8f9fa;
            border-radius: 15px;
            border-left: 5px solid #667eea;
        }
        
        .section h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        .network-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .network-stat {
            background: white;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #e9ecef;
        }
        
        .network-stat-value {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }
        
        .network-stat-label {
            color: #666;
            font-size: 0.9em;
        }
        
        .gephi-section {
            background: #e3f2fd;
            border-left-color: #2196F3;
        }
        
        .button {
            display: inline-block;
            padding: 12px 25px;
            background: #667eea;
            color: white;
            text-decoration: none;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }
        
        .button:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }
        
        .button.success {
            background: #28a745;
        }
        
        .button.success:hover {
            background: #218838;
        }
        
        .alert {
            padding: 15px;
            margin: 20px 0;
            border-radius: 8px;
            border-left: 5px solid;
        }
        
        .alert.success {
            background: #d4edda;
            color: #155724;
            border-left-color: #28a745;
        }
        
        .alert.warning {
            background: #fff3cd;
            color: #856404;
            border-left-color: #ffc107;
        }
        
        .alert.error {
            background: #f8d7da;
            color: #721c24;
            border-left-color: #dc3545;
        }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        .insights-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .insight-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .insight-title {
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }
        
        .insight-description {
            color: #666;
            line-height: 1.5;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üî¨ Data Science Dashboard</h1>
            <p>Napredna analiza podataka iz ankete o AI alatima</p>
        </div>
        
        <div class="navigation">
            <a href="{{ url_for('index') }}" class="nav-link">üìã Anketa</a>
            <a href="{{ url_for('results') }}" class="nav-link">üìà Rezultati</a>
            <a href="{{ url_for('analytics') }}" class="nav-link">üìä Analitika</a>
            <a href="{{ url_for('data_science_dashboard') }}" class="nav-link active">üî¨ Data Science</a>
        </div>
        
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert {{ category }}">{{ message }}</div>
                {% endfor %}
            {% endif %}
        {% endwith %}
        
        <!-- File Watcher Status -->
        <div class="alert success" id="file-watcher-status">
            <strong>üîÑ Automatsko A≈æuriranje:</strong> 
            <span id="watcher-message">Proveravam status...</span>
        </div>
        
        <!-- Summary Statistics -->
        <div class="section">
            <h2>üìä Data Science Summary</h2>
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">{{ summary.total_participants }}</div>
                    <div class="stat-label">Uƒçesnika</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ summary.total_ai_interactions }}</div>
                    <div class="stat-label">AI Interakcije</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ summary.total_quiz_responses }}</div>
                    <div class="stat-label">Kviz Odgovori</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ summary.unique_tools }}</div>
                    <div class="stat-label">Jedinstvenih Alata</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">{{ "%.1f"|format(summary.avg_quiz_score) }}%</div>
                    <div class="stat-label">Proseƒçan Kviz Skor</div>
                </div>
            </div>
        </div>
        
        <!-- Network Analysis -->
        <div class="section">
            <h2>üï∏Ô∏è Network Analiza</h2>
            {% if network_stats.get('error') %}
                <div class="alert error">
                    <strong>Gre≈°ka:</strong> {{ network_stats.error }}
                </div>
            {% else %}
                <div class="network-stats">
                    <div class="network-stat">
                        <div class="network-stat-value">{{ network_stats.nodes }}</div>
                        <div class="network-stat-label">ƒåvorovi</div>
                    </div>
                    <div class="network-stat">
                        <div class="network-stat-value">{{ network_stats.edges }}</div>
                        <div class="network-stat-label">Veze</div>
                    </div>
                    <div class="network-stat">
                        <div class="network-stat-value">{{ network_stats.density }}</div>
                        <div class="network-stat-label">Gustina</div>
                    </div>
                    <div class="network-stat">
                        <div class="network-stat-value">{{ network_stats.connected_components }}</div>
                        <div class="network-stat-label">Komponente</div>
                    </div>
                </div>
                
                <div class="insights-grid">
                    <div class="insight-card">
                        <div class="insight-title">üéØ Network Interpretacija</div>
                        <div class="insight-description">
                            {% if network_stats.density > 0.3 %}
                                Mre≈æa ima visoku gustinu ({{ network_stats.density }}), ≈°to ukazuje na sna≈æne veze izmeƒëu uƒçesnika i AI alata.
                            {% elif network_stats.density > 0.1 %}
                                Umerena gustina mre≈æe ({{ network_stats.density }}) pokazuje balansiranu povezanost.
                            {% else %}
                                Niska gustina ({{ network_stats.density }}) ukazuje na specializovane grupe korisnika.
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="insight-card">
                        <div class="insight-title">üìà Skalabilnost</div>
                        <div class="insight-description">
                            Sa {{ network_stats.nodes }} ƒçvorova i {{ network_stats.edges }} veza, 
                            mre≈æa je {{  'velika' if network_stats.nodes > 100 else 'mala do srednja' }} 
                            i pogodna za dublje analize.
                        </div>
                    </div>
                </div>
            {% endif %}
        </div>
        
        <!-- Gephi Export -->
        <div class="section gephi-section">
            <h2>üì° Gephi Integration</h2>
            <p><strong>Gephi</strong> je moƒáan alat za vizualizaciju i analizu mre≈æa. Exportovani fajlovi omoguƒáavaju:</p>
            
            <div class="insights-grid">
                <div class="insight-card">
                    <div class="insight-title">üé® Vizualizacija</div>
                    <div class="insight-description">
                        Kreiranje interaktivnih graf vizualizacija sa moguƒánostima zoom-a, filtriranja i layouta
                    </div>
                </div>
                
                <div class="insight-card">
                    <div class="insight-title">üîç Community Detection</div>
                    <div class="insight-description">
                        Automatsko otkrivanje grupa srodnih korisnika na osnovu AI alata koje koriste
                    </div>
                </div>
                
                <div class="insight-card">
                    <div class="insight-title">üìä Centralnost Mere</div>
                    <div class="insight-description">
                        Identifikovanje najuticajnijih ƒçvorova (korisnika ili alata) u mre≈æi
                    </div>
                </div>
            </div>
            
            {% if gephi_files.get('error') %}
                <div class="alert error">
                    <strong>Gre≈°ka pri kreiranju Gephi fajlova:</strong> {{ gephi_files.error }}
                </div>
            {% else %}
                <div class="alert success">
                    <strong>‚úÖ Gephi fajlovi uspe≈°no kreirani:</strong><br>
                    ‚Ä¢ Nodes: <code>{{ gephi_files.nodes }}</code><br>
                    ‚Ä¢ Edges: <code>{{ gephi_files.edges }}</code>
                </div>
            {% endif %}
            
            <a href="{{ url_for('export_gephi') }}" class="button success">üîÑ Regeneri≈°i Gephi Fajlove</a>
            
            <div class="code-block">
# Kako koristiti u Gephi:
# 1. Otvorite Gephi
# 2. File -> Open -> Izaberite gephi_edges.csv
# 3. Kada se pojavi dialog, oznaƒçite "Edges table" 
# 4. Importujte nodes fajl: File -> Import Spreadsheet -> gephi_nodes.csv
# 5. Izaberite layout algoritam (npr. ForceAtlas2)
# 6. Eksperimentirajte sa bojama i veliƒçinama ƒçvorova
            </div>
        </div>
        
        <!-- Popular Tools and Patterns -->
        <div class="section">
            <h2>üõ†Ô∏è AI Alati i Patterns</h2>
            <div class="insights-grid">
                <div class="insight-card">
                    <div class="insight-title">üî• Najpopularniji Alati</div>
                    <div class="insight-description">
                        {% if summary.most_popular_tools %}
                            {% for tool, count in summary.most_popular_tools.items() %}
                                <strong>{{ tool }}:</strong> {{ count }} korisnika<br>
                            {% endfor %}
                        {% else %}
                            Nema podataka o popularnim alatima
                        {% endif %}
                    </div>
                </div>
                
                <div class="insight-card">
                    <div class="insight-title">üìà Usage Patterns</div>
                    <div class="insight-description">
                        {% if summary.pattern_types %}
                            {% for pattern, count in summary.pattern_types.items() %}
                                <strong>{{ pattern.replace('_', ' ').title() }}:</strong> {{ count }}<br>
                            {% endfor %}
                        {% else %}
                            Nema podataka o patterns kori≈°ƒáenja
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Advanced Analytics Options -->
        <div class="section">
            <h2>üöÄ Napredne Analize</h2>
            <p>Sa postojeƒáim podacima mo≈æete pokrenuti:</p>
            
            <div class="insights-grid">
                <div class="insight-card">
                    <div class="insight-title">üìà Pandas Analize</div>
                    <div class="insight-description">
                        Korelacije, cross-tabulation, clustering korisnika po demografskim podacima
                        <div class="code-block" style="margin-top: 10px; font-size: 0.8em;">
python advanced_analytics.py
                        </div>
                    </div>
                </div>
                
                <div class="insight-card">
                    <div class="insight-title">üï∏Ô∏è NetworkX Analize</div>
                    <div class="insight-description">
                        Centrality measures, community detection, shortest paths izmeƒëu korisnika
                        <div class="code-block" style="margin-top: 10px; font-size: 0.8em;">
# U Python konzoli:
from data_science_extension import *
manager = DataScienceManager()
G = manager.create_network_graph()
                        </div>
                    </div>
                </div>
                
                <div class="insight-card">
                    <div class="insight-title">üé® Gephi Vizualizacije</div>
                    <div class="insight-description">
                        Interaktivne mre≈æne vizualizacije, layout algoritmi, community bojenje
                        <div class="code-block" style="margin-top: 10px; font-size: 0.8em;">
# Fajlovi za import u Gephi:
data/exports/gephi_nodes.csv
data/exports/gephi_edges.csv
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- CSV Files Created -->
        <div class="section">
            <h2>üìÅ Kreirani CSV Fajlovi</h2>
            <p>Sistem automatski kreira sledeƒáe CSV fajlove pogodne za analizu:</p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                {% if summary.files_created %}
                    {% for file_type in summary.files_created %}
                        <div style="background: white; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745;">
                            <strong>{{ file_type }}.csv</strong><br>
                            <small style="color: #666;">
                                {% if file_type == 'participants' %}
                                    Demografski podaci uƒçesnika
                                {% elif file_type == 'ai_knowledge' %}
                                    Znanje o AI alatima po uƒçesniku
                                {% elif file_type == 'quiz_responses' %}
                                    Individualni odgovori na kviz
                                {% elif file_type == 'relationships' %}
                                    Veze izmeƒëu korisnika i alata
                                {% elif file_type == 'tool_usage_patterns' %}
                                    Patterns kori≈°ƒáenja alata
                                {% else %}
                                    {{ file_type.replace('_', ' ').title() }}
                                {% endif %}
                            </small>
                        </div>
                    {% endfor %}
                {% endif %}
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 40px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
            <p><strong>üí° Pro Tip:</strong> Za najbolje rezultate, kombinujte Pandas za statistiƒçke analize, 
            NetworkX za mre≈æne algoritme i Gephi za vizualizacije!</p>
        </div>
    </div>
    
    <script>
        // Check file watcher status
        function checkFileWatcherStatus() {
            fetch('/file_watcher_status')
                .then(response => response.json())
                .then(data => {
                    const statusElement = document.getElementById('file-watcher-status');
                    const messageElement = document.getElementById('watcher-message');
                    
                    if (data.status === 'running') {
                        statusElement.className = 'alert success';
                        messageElement.textContent = 'AKTIVNO - Automatski prati promene u survey_responses.csv';
                    } else if (data.status === 'stopped') {
                        statusElement.className = 'alert warning';
                        messageElement.textContent = 'NEAKTIVNO - File Watcher nije pokrenut';
                    } else {
                        statusElement.className = 'alert error';
                        messageElement.textContent = 'NEDOSTUPNO - File Watcher funkcionalnost nije dostupna';
                    }
                })
                .catch(error => {
                    const statusElement = document.getElementById('file-watcher-status');
                    const messageElement = document.getElementById('watcher-message');
                    statusElement.className = 'alert error';
                    messageElement.textContent = 'GRE≈†KA - Nije moguƒáe proveriti status';
                });
        }
        
        // Check status on page load
        checkFileWatcherStatus();
        
        // Check status every 30 seconds
        setInterval(checkFileWatcherStatus, 30000);
    </script>
</body>
</html>
